jQuery(document).ready(function(l){"use strict";var f=topAtts,e=l("#year-select"),t=l(".top-data-content"),n=[];function i(i){var u=n.filter(function(e){return parseInt(e.year,10)===i}),o=u.map(function(e){return e.wiki_db});console.log(u),t.each(function(){var e=l(this),i=l(this).attr("id"),t=u.find(function(e){return e.wiki_db===i});if(e.hide(),-1<o.indexOf(i)){var n=t["desc_"+f.lang.replaceAll("wiki","")].replaceAll('"',""),a=t.pagetitle.replaceAll("_"," "),r=t.image,d=d3.format(",")(t.edits),c=t.daily_edits.split("_").map(function(e){return parseInt(e,10)}),s="#"+i+"-graph";l(s).empty(),function(e,i){var t,n,a,r,d,c=300/e.length;t=d3.scaleLinear().domain([0,d3.max(e,function(e){return e})]).nice().range([40,6]),n=d3.scaleLinear().domain([0,e.length]).range([0,300]),a=d3.scaleLinear().domain([0,d3.max(e,function(e){return e})]).nice().range(["#f8f9fa","#202122"]),r=d3.line().defined(function(e){return!isNaN(e)}).curve(d3.curveCardinal.tension(.5)).x(function(e,i){return n(i)}).y(function(e){return t(e)}),(d=d3.select(i).append("svg").attr("viewBox",[0,0,300,46])).append("g").append("path").datum(e).attr("fill","none").attr("stroke","#72777D").attr("stroke-width",1).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("d",r),d.append("g").selectAll("rect").data(e).join("rect").attr("width",c).attr("height",6).style("fill",function(e){return a(e)}).attr("x",function(e,i){return i*c}).attr("y",40)}(c,s),e.find(".heading").text(a),e.find(".desc").text(n+" ").append(l("<a></a>").attr("href","/").text(function(e){var i="";switch(e){case"enwiki":i="English Wikipedia";break;case"arwiki":i="Arabic Wikipedia";break;case"dewiki":i="German Wikipedia";break;case"eswiki":i="Spanish Wikipedia";break;case"frwiki":i="French Wikipedia";break;case"ruwiki":i="Russian Wikipedia";break;case"zhwiki":i="Chinese Wikipedia";break;default:i="Wikipedia"}return i}(t.wiki_db))),e.find(".article-image").css("background-image","url("+r+")"),e.find(".data p").text(d+" edits"),e.fadeIn()}})}function a(){var e="";l("#year-select option:selected").each(function(){e+=l(this).text()+" "}),i(parseInt(e,10))}t.each(function(){l(this).hide()}),d3.csv(f.url,function(e){return e}).then(function(e){n=e,a()}),e.change(a)});