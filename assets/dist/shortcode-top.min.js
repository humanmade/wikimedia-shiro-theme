jQuery(document).ready(function(k){"use strict";var v,g,w,m=topAtts,n=k("#"+m.id),i=k("#year-select"),b=n.find(".no-data"),t=k(".top-data-content"),a={edits:[],views:[]};function r(u,e){var o="views"===e?"wiki":"wiki_db",l=u.map(function(e){return e[o]}),f="views"===e?"views":"edits",p="views"===e?"pageviews":"edits",h="views"===e?"daily_views":"daily_edits";console.log(u,e),t.each(function(){var e=k(this),i=k(this).attr("id"),t=u.find(function(e){return e[o]===i});if(b.hide(),e.hide(),-1<l.indexOf(i)){var n=t["desc_"+m.lang.replaceAll("wiki","")].replaceAll('"',""),a=t.pagetitle.replaceAll("_"," "),r=t.image,d=d3.format(",")(t[p]),c=t[h].split("_").map(function(e){return parseInt(e,10)}),s="#"+i+"-graph";k(s).empty(),function(e,i){var t,n,a=300/e.length;t=d3.scaleLinear().domain([0,d3.max(e,function(e){return e})]).nice().range([40,6]),n=d3.scaleLinear().domain([0,e.length]).range([0,300]),v=d3.scaleLinear().domain([0,d3.max(e,function(e){return e})]).nice().range(["#f8f9fa","#202122"]),g=d3.line().defined(function(e){return!isNaN(e)}).curve(d3.curveCardinal.tension(.5)).x(function(e,i){return n(i)}).y(function(e){return t(e)}),(w=d3.select(i).append("svg").attr("viewBox",[0,0,300,46])).append("g").append("path").datum(e).attr("fill","none").attr("stroke","#72777D").attr("stroke-width",1).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("d",g),w.append("g").selectAll("rect").data(e).join("rect").attr("width",a).attr("height",6).style("fill",function(e){return v(e)}).attr("x",function(e,i){return i*a}).attr("y",40)}(c,s),e.find(".heading").text(a),e.find(".desc").text(n+" ").append(k("<a></a>").attr("href","https://"+t[o].replace("wiki","")+".wikipedia.org/wiki/"+t.pagetitle).attr("target","_blank").text(function(e){var i="";switch(e){case"enwiki":i="English Wikipedia";break;case"arwiki":i="Arabic Wikipedia";break;case"dewiki":i="German Wikipedia";break;case"eswiki":i="Spanish Wikipedia";break;case"frwiki":i="French Wikipedia";break;case"ruwiki":i="Russian Wikipedia";break;case"zhwiki":i="Chinese Wikipedia";break;default:i="Wikipedia"}return i}(t[o]))),e.find(".article-image").css("background-image","url("+r+")"),e.find(".data p").text(d+" "+f),e.fadeIn()}else b.show()})}function d(){var e=n.find("input:checked").val();0<a[e].length&&c(e),i.find("option").each(function(){var i=parseInt(k(this).val(),10);0<a[e].filter(function(e){return parseInt(e.year,10)===i}).length?k(this).removeAttr("disabled"):k(this).attr("disabled","true")})}function c(e){var i="",t="string"==typeof e?e:n.find("input:checked").val();k("#year-select option:selected").each(function(){i+=k(this).text()+" "}),r(a[t].filter(function(e){return parseInt(e.year,10)===parseInt(i,10)}),t)}t.each(function(){k(this).hide()}),d3.csv(m.url_edits,function(e){return e}).then(function(e){a.edits=e,d()}),d3.csv(m.url_views,function(e){return e}).then(function(e){a.views=e,d()}),i.change(c),n.find("input").change(d)});