jQuery(document).ready(function(q){"use strict";q(".d3-dataprofiles").each(function(){!function(g){var t=q("#"+g),v=10,w=d3.format(","),A=t.width(),b={x:A<400?(A-4*v)/2:190,y:125},k=t.data("max-feature-1")?t.data("max-feature-1"):90,j=t.data("max-feature-2")?t.data("max-feature-2"):90,r=Math.max(Math.floor(A/b.x),2),M=t.data("chart-masterunit")?t.data("chart-masterunit"):5e5,L=30,B=t.data("chart-raw"),P=t.data("slice-start"),R=t.data("slice-end"),F=t.data("chart-labels"),z=t.data("chart-icons"),C=t.data("chart-except"),S=C?B[F[0]]:"",Y=4.2,I=C?b.y*Y:O(null,R-P-1)+b.y;function O(t,e){var a=6*v;return(C?0:5*v)+(b.y+a)*Math.floor(e/r)}function Q(t,e){return e%r*b.x}function T(t,e,a,r){return parseFloat(t.selectAll(e).nodes()[a].getAttribute(r))}!function(){if(B){var t,a,r,n,l,e=d3.select("#"+g),d=[q("#feature1"),q("#feature2"),q("#feature3")],i=A/I,c=B.map(function(t,e){var a=Math.floor(t[F[3]]/M),r=t[F[3]]%M,n=0===e?L:5,l=Math.ceil(a/n);t.unitArray=[];for(var i=0;i<l;i++)for(var c=0;c<n;c++)t.unitArray.push({x:c,y:i,value:M});return t.unitArray=t.unitArray.slice(0,a),t.unitArray[t.unitArray.length-1].value=r,t.Rows=l,t}),x=c.slice(P,R),o=d3.max(c,function(t){return t.Rows}),u=d3.scaleLinear().domain([0,d3.max(B,function(t){return t[F[1]]})]).range([0,k]),s=d3.scaleLinear().domain([0,d3.max(B,function(t){return t[F[2]]})]).range([0,j]),f=d3.scaleLinear().domain([0,M]).range([0,4]),h=d3.scaleLinear().domain([0,o]).range([0,4*o*2]),p=d3.scaleLinear().domain([0,5]).range([0,50]);t=e.append("svg").attr("width",A).attr("height",I).attr("perserveAspectRatio","xMidYMid meet").attr("viewBox","0 0 "+A+" "+I),q(window).resize(function(){var t=e.node().getBoundingClientRect().width;e.selectAll("svg").attr("width",t),e.selectAll("svg").attr("height",t/i)}),a=t.append("g").call(function(t){return t.attr("transform","translate("+v+","+v+")").attr("class","profile-feature1").selectAll("circle").data(x).join("circle").attr("cx",function(t,e){return C?Q(0,e)+A/4:Q(0,e)+u(t[F[1]])}).attr("cy",function(t,e){return O(0,e)+u(t[F[1]])}).attr("r",function(t){return u(t[F[1]])})}),r=t.append("g").call(function(t,a){return t.attr("transform","translate("+v+","+v+")").attr("class","profile-feature2").selectAll("rect").data(x).join("rect").attr("x",function(t,e){return C?A/2+(A/2-.75*s(t[F[2]]))/2:T(a,"circle",e,"cx")+T(a,"circle",e,"r")+v/2}).attr("y",function(t,e){return O(0,e)}).attr("width",function(t){return.75*s(t[F[2]])}).attr("height",function(t){return s(t[F[2]])}).attr("rx",function(t){return.08*s(t[F[2]])}).attr("ry",function(t){return.08*s(t[F[2]])})},a),n=t.append("g").call(function(t,e,a){t.attr("class","profile-feature3");for(var r=0;r<x.length;r++){var n=f(M)/3*2,l=T(a,"rect",r,"x")+T(a,"rect",r,"width")+v,i=T(a,"rect",r,"y")+n,c=(A-p(L))/2,o=T(e,"circle",r,"cx")+T(e,"circle",r,"r")+5*v,u=C?c:l,s=C?o:i;t.append("g").attr("class","viewsContainer").attr("transform","translate("+v+","+v+")").selectAll("ellipse").data(x[r].unitArray).join("ellipse").attr("class","views-"+r).attr("cx",function(t){return u+p(t.x)}).attr("cy",function(t){return s+h(t.y)}).attr("rx",function(t){return f(t.value)}).attr("ry",function(t){return f(t.value)/3*2})}return t},a,r),t.append("g").call(function(t,e,a){return t.call(function(t){return t.append("g").attr("class","main-labels").selectAll("text").data(x).join("text").attr("text-anchor","start").attr("dy",-5).attr("x",function(t,e){return C?Q(0,e)+v*Y+v:Q(0,e)+2*v}).attr("y",function(t,e){return C?I-v:O(0,e)+.75*b.y+v}).text(function(t){return 4<F.length?t[F[4]]:t[F[0]]})}).call(function(t){return t.append("g").attr("class","main-label-ranks").style("display","none").selectAll("text").data(x).join("text").attr("text-anchor","start").attr("dy",-30).attr("x",function(t,e){return C?Q(0,e)+v*Y+v:Q(0,e)+2*v}).attr("y",function(t,e){return C?I-v:O(0,e)+.75*b.y+v}).text(function(t,e){return e+1+a})})},a,P),t.append("g").call(function(t){var a=C?I:b.y-v,r=C?v*Y:v;return t.attr("stroke-width",2).attr("class","borderleft").selectAll("line").data(x).join("line").attr("x1",function(t,e){return Q(0,e)+2}).attr("x2",function(t,e){return Q(0,e)+r}).attr("y1",function(t,e){return O(0,e)}).attr("y2",function(t,e){return O(0,e)+a})}),C?t.append("g").call(function(t,e,a,r){var n,l=x[0],i=T(a,"rect",0,"x"),c=T(a,"rect",0,"y"),o=T(a,"rect",0,"width"),u=T(a,"rect",0,"height"),s=T(r,"ellipse",0,"cx"),d=T(r,"ellipse",Math.floor(15)-1,"cx"),f=T(r,"ellipse",L*(l.Rows-1),"cy"),h=L*l.Rows%l.unitArray.length>Math.ceil(15)+1,p=[{x:T(e,"circle",0,"cx"),y:T(e,"circle",0,"cy")+T(e,"circle",0,"r")-v,y2:I-60,h:45,class:"profile-feature1",highlight:!0,name:[w(l[F[1]])+" "+F[1]]},{x:i+.5*o,y:c+u-v,y2:I-60,h:45,class:"profile-feature2",highlight:!0,name:[w(l[F[2]])+" "+F[2]]},{x:d,y:h?f:f+v,y2:I-90,h:45,class:"profile-feature3",highlight:!0,name:[w(l[F[3]])+" "+F[3]]},{x:s,y:f,y2:I-120,h:20,class:"profile-feature3",highlight:!1,name:[w(M),F[3]]}];return t.append("g").attr("transform","translate("+v+","+v+")").attr("class","data-label-lines").selectAll("line").data(p).join("line").attr("class",function(t){return t.class}).attr("x1",function(t){return t.x}).attr("x2",function(t){return t.x}).attr("y1",function(t){return t.y}).attr("y2",function(t){return t.y+t.h}).attr("stroke-dasharray",function(t){return t.highlight?"":v/3+","+v/4}),(n=t.append("g").attr("transform","translate("+v+","+v+")").attr("class","data-label-text").selectAll("text").data(p).join("text").attr("class",function(t){return t.class}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y+t.h}).attr("dy",1.5*v).attr("stroke-width",0).attr("font-weight",function(t){return t.highlight?"bold":"normal"}).attr("text-anchor","middle")).append("tspan").attr("x",function(t){return t.x}).text(function(t){return t.name[0]}),n.append("tspan").attr("x",function(t){return t.x}).attr("dy",16).text(function(t){return t.name[1]}),t},a,r,n):(l=t.append("g").attr("class","tooltip"),t.append("g").attr("opacity",0).attr("class","tooltipgrid").selectAll("rect").data(x).join("rect").attr("class","hover").attr("x",function(t,e){return Q(0,e)}).attr("y",function(t,e){return O(0,e)}).attr("width",b.x).attr("height",b.y).on("touchstart mouseover",function(t,e){x[e][F[0]]!==S&&l.call(y,e,a,r,n)}).on("touchend mouseout",function(){l.call(y,null)}),q(".chart-options input[type='checkbox']").click(m),m())}function y(t,e,a,r,n){if(null===e)return t.transition().attr("opacity",0).transition().style("display","none");var l=T(a,"circle",e,"cx"),i=T(r,"rect",e,"x"),c=T(r,"rect",e,"width"),o=T(n,".views-"+e,Math.min(Math.floor(2.5),x[e].unitArray.length-1),"cx")+v,u=v,s=[{value:x[e][F[1]],path:"M"+(l+v)+" "+(O(0,e)+v)+"v -36h",labelPos:[l,O(0,e)-36]},{value:x[e][F[2]],path:"M"+(i+v+c/2)+" "+(O(0,e)+v)+"v -18h",labelPos:[i+c/2,O(0,e)-18]},{value:x[e][F[3]],path:"M"+o+" "+(O(0,e)+.7*v)+"v -6h",labelPos:[o-v,O(0,e)-6]}];return t.transition().attr("opacity",1).style("display",null).style("pointer-events","none"),t.selectAll("path").data(s).join("path").attr("class","hover-label-lines").attr("d",function(t){return t.path}).style("display",function(t,e){return d[e].is(":checked")?"block":"none"}),t.selectAll("text").data(s).join("text").attr("x",function(t){return t.labelPos[0]}).attr("y",function(t){return t.labelPos[1]}).attr("dy",.5*v).attr("dx",2*v).text(function(t){return w(t.value)}).style("display",function(t,e){return d[e].is(":checked")?"block":"none"}),4<F.length&&t.append("text").attr("x",Q(0,e)+v).attr("y",O(0,e)+b.y).attr("dy",-v).attr("dx",v).text(x[e][F[0]]),t.selectAll("image").data(s).join("image").attr("xlink:href",function(t,e){return z[e]}).attr("width",u).attr("height",u).attr("x",function(t){return t.labelPos[0]+.5*v}).attr("y",function(t){return t.labelPos[1]-.5*u}).style("display",function(t,e){return d[e].is(":checked")?"block":"none"}),t}function m(){for(var t=0;t<d.length;t++){var e=q(".profile-feature"+(t+1));d[t].is(":checked")?e.fadeIn():e.fadeOut()}d[0].is(":checked")||d[1].is(":checked")||d[2].is(":checked")?q(".main-label-ranks").fadeOut():q(".main-label-ranks").fadeIn()}}()}(this.id)})}),jQuery(document).ready(function(w){"use strict";function t(c){var t=w("#"+c),o=w(window).width()<762,u=30,e=o?20:60,a=60,s=40,d=t.width(),f=d-s-e,h=300-u-a,p=1.5,x=4,y=t.data("stroke-color"),m="month"===t.data("time-format")?{month:"long"}:{month:"short",day:"numeric",year:"numeric"},r=d3.timeParse("%Y-%m-%d"),n=t.data("chart-raw"),g=n?n.map(function(t){return t.date=r(t.date),t}):null;function v(t,e,a,r){if(!e)return t.style("display","none");t.attr("class","tooltip").style("display",null).style("pointer-events","none");var n=t.selectAll("rect").data([null]).join("rect").attr("rx",2).attr("ry",2),l=t.selectAll("text").data([null]).join("text").call(function(t){return t.selectAll("tspan").data(e.split(/\n/)).join("tspan").attr("x",0).attr("y",function(t,e){return 1.2*e+"em"}).style("font-weight",function(t,e){return e?null:"bold"}).text(function(t){return t})}),i=l.node().getBBox(),c=i.width,o=i.height;return t.selectAll("circle").data([null]).join("circle").attr("r",x).attr("stroke-width",p).attr("fill",r?"none":"white"),n.attr("width",c+20).attr("height",o+20),f<a+c?(l.attr("transform","translate("+(-c-20)+","+-((o-20)/2-2)+")"),n.attr("x",-(c+10+20)).attr("y",-(o+20)/2)):(l.attr("transform","translate(20,"+-((o-20)/2-2)+")"),n.attr("x",10).attr("y",-(o+20)/2)),t}!function(){if(g){var t,a,e=4,i=d3.scaleTime().nice().domain(d3.extent(g,function(t){return t.date})).range([0,f]),r=d3.scaleLinear().domain([0,d3.max(g,function(t){return t.value})]).range([h,0]),n=d3.select("#"+c),l=d/300;t=n.append("svg").attr("width",d).attr("height",300).attr("perserveAspectRatio","xMidYMid meet").attr("viewBox","0 0 "+d+" 300").append("g").attr("transform","translate("+s+","+u+")"),w(window).resize(function(){var t=n.node().getBoundingClientRect().width;n.selectAll("svg").attr("width",t),n.selectAll("svg").attr("height",t/l)}),t.append("g").call(function(t){t.attr("transform","translate(0,"+h+")").call(d3.axisBottom(i).ticks(d3.timeMonth,1).tickFormat(o?d3.timeFormat("%b"):d3.timeFormat("%B"))).call(function(t){t.select(".domain").remove()})}),t.append("g").call(function(t){t.attr("class","yAxis").call(d3.axisLeft(r).ticks(e).tickFormat(d3.format(".2s")).tickSize(-1*f)).call(function(t){t.select(".domain").remove()})}),t.append("path").datum(g).attr("fill","none").attr("stroke-width",p).attr("stroke","black").attr("class","line "+y).attr("d",d3.line().x(function(t){return i(t.date)}).y(function(t){return r(t.value)})),t.append("g").selectAll("circle").data(g.filter(function(t){return t.event})).enter("circle").append("circle").attr("class","circle "+y).attr("r",x).attr("cx",function(t){return i(t.date)}).attr("cy",function(t){return r(t.value)}),a=t.append("g"),t.append("rect").attr("class","overlay").attr("pointer-events","all").attr("x",0).attr("y",0).attr("width",f).attr("height",h).on("touchmove mousemove",function(){var t=function(t){var e=d3.bisector(function(t){return t.date}).left,a=i.invert(t),r=e(g,a,1),n=g[r-1],l=g[r];return a-n.date>l.date-a?l:n}(d3.mouse(this)[0]),e=t.date.toLocaleString(void 0,m)+"\n"+d3.format(",")(t.value);a.attr("transform","translate("+i(t.date)+","+r(t.value)+")").call(v,e,i(t.date),t.event),t.event?(w("#label-date").text(t.date.toLocaleString(void 0,m)),w("#label-name").text(t.event),w("#linechart-label").css("opacity",1),w("#linechart-label").css("max-height","10rem")):(w("#linechart-label").css("opacity",0),w("#linechart-label").css("max-height","2rem"))}).on("touchend mouseleave",function(){a.call(v,null)})}}()}w(".d3-linechart").each(function(){t(this.id)})});
//# sourceMappingURL=maps/datavis.min.js.map
