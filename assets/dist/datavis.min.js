jQuery(document).ready(function(J){"use strict";J(".d3-dataprofiles").each(function(){!function(v){var t=J("#"+v),w=10,A=d3.format(","),b=t.width(),k={x:b<380?b/2-w:190,y:125},j=t.data("max-feature-1")?t.data("max-feature-1"):90,M=t.data("max-feature-2")?t.data("max-feature-2"):90,a=Math.max(Math.floor(b/k.x),2),L=J("body").width(),B=190*a,P=500,R=t.data("chart-masterunit")?t.data("chart-masterunit"):5e5,F=b<B?24:30,z=t.data("chart-raw"),C=t.data("slice-start"),S=t.data("slice-end"),Y=t.data("chart-labels"),I=45,O=t.data("chart-icons"),Q=t.data("chart-except"),T=Q?z[Y[0]]:"",q=3.5,D=Q?k.y*q:E(null,S-C-1)+k.y;function E(t,e){var r=6*w;return(Q?0:5*w)+(k.y+r)*Math.floor(e/a)}function G(t,e){return e%a*k.x}function H(t,e,r,a){return parseFloat(t.selectAll(e).nodes()[r].getAttribute(a))}!function(){if(z){var t,r,a,n,l,e=d3.select("#"+v),f=[J("#feature1"),J("#feature2"),J("#feature3")],i=b/D,c=z.map(function(t,e){var r=Math.floor(t[Y[3]]/R),a=t[Y[3]]%R,n=0===e?F:5,l=Math.ceil(r/n);t.unitArray=[];for(var i=0;i<l;i++)for(var c=0;c<n;c++)t.unitArray.push({x:c,y:i,value:R});return t.unitArray=t.unitArray.slice(0,r),t.unitArray[t.unitArray.length-1].value=a,t.Rows=l,t}),y=c.slice(C,S),o=d3.max(c,function(t){return t.Rows}),u=d3.scaleLinear().domain([0,d3.max(z,function(t){return t[Y[1]]})]).range([0,j]),s=d3.scaleLinear().domain([0,d3.max(z,function(t){return t[Y[2]]})]).range([0,M]),p=d3.scaleLinear().domain([0,R]).range([0,4]),d=d3.scaleLinear().domain([0,o]).range([0,4*o*2]),h=d3.scaleLinear().domain([0,5]).range([0,50]),x=2*u.range()[1]+d.range()[1]+4*(I+w);q=(D=Q&&D<x?x:D)/k.y,t=e.append("svg").attr("width",b).attr("height",D).attr("perserveAspectRatio","xMidYMid meet").attr("viewBox","0 0 "+b+" "+D),J(window).resize(function(){var t=e.node().getBoundingClientRect().width;e.selectAll("svg").attr("width",t),e.selectAll("svg").attr("height",t/i)}),r=t.append("g").call(function(t){return t.attr("transform","translate("+w+","+w+")").attr("class","profile-feature1").selectAll("circle").data(y).join("circle").attr("cx",function(t,e){return Q?G(0,e)+Math.max(b/4,u(t[Y[1]])+w):G(0,e)+u(t[Y[1]])}).attr("cy",function(t,e){return E(0,e)+u(t[Y[1]])}).attr("r",function(t){return u(t[Y[1]])})}),a=t.append("g").call(function(t,i){return t.attr("transform","translate("+w+","+w+")").attr("class","profile-feature2").selectAll("rect").data(y).join("rect").attr("x",function(t,e){var r=H(i,"circle",e,"cx")+H(i,"circle",e,"r")+w/2,a=.4*b+(b/2-.75*s(t[Y[2]]))/2,n=Q?a:r,l=H(i,"circle",e,"cx")+H(i,"circle",e,"r")+3*w;return b<B&&Q?l:n}).attr("y",function(t,e){return E(0,e)}).attr("width",function(t){return.75*s(t[Y[2]])}).attr("height",function(t){return s(t[Y[2]])}).attr("rx",function(t){return.08*s(t[Y[2]])}).attr("ry",function(t){return.08*s(t[Y[2]])})},r),n=t.append("g").call(function(t,e,r){t.attr("class","profile-feature3");for(var a=0;a<y.length;a++){var n=p(R)/3*2,l=H(r,"rect",a,"x")+H(r,"rect",a,"width")+w,i=H(r,"rect",a,"y")+n,c=(b-h(F))/2,o=H(e,"circle",a,"cx")+H(e,"circle",a,"r")+I+2*w,u=Q?c:l,s=Q?o:i;t.append("g").attr("class","viewsContainer").attr("transform","translate("+w+","+w+")").selectAll("ellipse").data(y[a].unitArray).join("ellipse").attr("class","views-"+a).attr("cx",function(t){return u+h(t.x)}).attr("cy",function(t){return s+d(t.y)}).attr("rx",function(t){return p(t.value)}).attr("ry",function(t){return p(t.value)/3*2})}return t},r,a),t.append("g").call(function(t,e,r){var a=Q?w*q+w:2*w,n=Q?D-w:.75*k.y+w;return t.call(function(t){return t.append("g").attr("class","main-labels").selectAll("text").data(y).join("text").attr("text-anchor","start").attr("dy",-5).attr("x",function(t,e){return L<P?G(0,e)+w:G(0,e)+a}).attr("y",function(t,e){return E(0,e)+n}).text(function(t){return 4<Y.length?t[Y[4]]:t[Y[0]]})}).call(function(t){return t.append("g").attr("class","main-label-ranks").style("display","none").selectAll("text").data(y).join("text").attr("text-anchor","start").attr("dy",-30).attr("x",function(t,e){return L<P?G(0,e)+w:G(0,e)+a}).attr("y",function(t,e){return E(0,e)+n}).text(function(t,e){return e+1+r})})},r,C),t.append("g").call(function(t){var r=Q?D:k.y-w,a=Q?w*q:w;return t.attr("stroke-width",2).attr("class","borderleft").selectAll("line").data(y).join("line").attr("x1",function(t,e){return G(0,e)+2}).attr("x2",function(t,e){return L<P?G(0,e)+2:G(0,e)+a}).attr("y1",function(t,e){return E(0,e)}).attr("y2",function(t,e){return E(0,e)+r})}),Q?t.append("g").call(function(t,e,r,a){var n,l=y[0],i=H(r,"rect",0,"x"),c=H(r,"rect",0,"y"),o=H(r,"rect",0,"width"),u=H(r,"rect",0,"height"),s=H(a,"ellipse",F-1,"cx"),d=H(a,"ellipse",Math.floor(F/2)-1,"cx"),f=H(a,"ellipse",F*(l.Rows-1),"cy"),h=F*l.Rows%l.unitArray.length>Math.ceil(F/2)+1,x=[{x:H(e,"circle",0,"cx"),y:H(e,"circle",0,"cy")+H(e,"circle",0,"r")-w,y2:D-60,h:I,class:"profile-feature1",highlight:!0,name:[A(l[Y[1]])+" "+Y[1]]},{x:i+.5*o,y:c+u-w,y2:D-60,h:I,class:"profile-feature2",highlight:!0,name:[A(l[Y[2]])+" "+Y[2]]},{x:d,y:h?f:f+w,y2:D-90,h:I,class:"profile-feature3",highlight:!0,name:[A(l[Y[3]])+" "+Y[3]]},{x:s,y:f-2*p.range()[1],y2:D-120,h:I/2,class:"profile-feature3",highlight:!1,name:[A(R),Y[3]]}];return t.append("g").attr("transform","translate("+w+","+w+")").attr("class","data-label-lines").selectAll("line").data(x).join("line").attr("class",function(t){return t.class}).attr("x1",function(t){return t.x}).attr("x2",function(t){return t.x}).attr("y1",function(t){return t.y}).attr("y2",function(t){return t.y+t.h}).attr("stroke-dasharray",function(t){return t.highlight?"":w/3+","+w/4}),(n=t.append("g").attr("transform","translate("+w+","+w+")").attr("class","data-label-text").selectAll("text").data(x).join("text").attr("class",function(t){return t.class}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y+t.h}).attr("dy",1.5*w).attr("stroke-width",0).attr("font-weight",function(t){return t.highlight?"bold":"normal"}).attr("text-anchor","middle")).append("tspan").attr("x",function(t){return t.x}).attr("dx",p.range()[1]).text(function(t){return t.name[0]}),n.append("tspan").attr("x",function(t){return t.x}).attr("dy",16).attr("dx",p.range()[1]).text(function(t){return t.name[1]}),t},r,a,n):(l=t.append("g").attr("class","tooltip"),t.append("g").attr("opacity",0).attr("class","tooltipgrid").selectAll("rect").data(y).join("rect").attr("class","hover").attr("x",function(t,e){return G(0,e)}).attr("y",function(t,e){return E(0,e)}).attr("width",k.x).attr("height",k.y).on("touchstart mouseover",function(t,e){y[e][Y[0]]!==T&&l.call(m,e,r,a,n)}).on("touchend mouseout",function(){l.call(m,null)}),J(".chart-options input[type='checkbox']").click(g),g())}function m(t,e,r,a,n){if(null===e)return t.transition().attr("opacity",0).transition().style("display","none");var l=H(r,"circle",e,"cx"),i=H(a,"rect",e,"x"),c=H(a,"rect",e,"width"),o=H(n,".views-"+e,Math.min(Math.floor(2.5),y[e].unitArray.length-1),"cx")+w,u=w,s=b<B?20:0,d=[{value:y[e][Y[1]],x:Math.round(l+w),y1:E(0,e)+w,h:36,labelPos:[l,E(0,e)-36]},{value:y[e][Y[2]],x:Math.round(i+w+c/2),y1:E(0,e)+w,h:18,labelPos:[i+c/2,E(0,e)-18]},{value:y[e][Y[3]],x:Math.round(o),y1:E(0,e)+2*p.range()[1],h:6,labelPos:[o-w-s,E(0,e)-6]}];return t.transition().attr("opacity",1).style("display",null).style("pointer-events","none"),t.selectAll("line").data(d).join("line").attr("class","hover-label-lines").attr("x1",function(t){return t.x}).attr("x2",function(t){return t.x}).attr("y1",function(t){return t.y1}).attr("y2",function(t){return t.y1-t.h}).style("display",function(t,e){return f[e].is(":checked")?"block":"none"}),t.selectAll("text").data(d).join("text").attr("x",function(t){return t.labelPos[0]}).attr("y",function(t){return t.labelPos[1]}).attr("dy",.5*w).attr("dx",2*w).text(function(t){return A(t.value)}).style("display",function(t,e){return f[e].is(":checked")?"block":"none"}),4<Y.length&&t.append("text").attr("x",L<P?G(0,e):G(0,e)+w).attr("y",E(0,e)+k.y).attr("dy",-w).attr("dx",w).text(y[e][Y[0]]),t.selectAll("image").data(d).join("image").attr("xlink:href",function(t,e){return O[e]}).attr("width",u).attr("height",u).attr("x",function(t){return t.labelPos[0]+.5*w}).attr("y",function(t){return t.labelPos[1]-.5*u}).style("display",function(t,e){return f[e].is(":checked")?"block":"none"}),t}function g(){for(var t=0;t<f.length;t++){var e=J(".profile-feature"+(t+1));f[t].is(":checked")?e.fadeIn():e.fadeOut()}f[0].is(":checked")||f[1].is(":checked")||f[2].is(":checked")?J(".main-label-ranks").fadeOut():J(".main-label-ranks").fadeIn()}}()}(this.id)})}),jQuery(document).ready(function(w){"use strict";function t(c){var t=w("#"+c),o=w(window).width()<762,u=30,e=o?20:60,r=60,s=40,d=t.width(),f=d-s-e,h=300-u-r,x=1.5,y=4,p=t.data("stroke-color"),m="month"===t.data("time-format")?{month:"long"}:{month:"short",day:"numeric",year:"numeric"},a=d3.timeParse("%Y-%m-%d"),n=t.data("chart-raw"),g=n?n.map(function(t){return t.date=a(t.date),t}):null;function v(t,e,r,a){if(!e)return t.style("display","none");t.attr("class","tooltip").style("display",null).style("pointer-events","none");var n=t.selectAll("rect").data([null]).join("rect").attr("rx",2).attr("ry",2),l=t.selectAll("text").data([null]).join("text").call(function(t){return t.selectAll("tspan").data(e.split(/\n/)).join("tspan").attr("x",0).attr("y",function(t,e){return 1.2*e+"em"}).style("font-weight",function(t,e){return e?null:"bold"}).text(function(t){return t})}),i=l.node().getBBox(),c=i.width,o=i.height;return t.selectAll("circle").data([null]).join("circle").attr("r",y).attr("stroke-width",x).attr("fill",a?"none":"white"),n.attr("width",c+20).attr("height",o+20),f<r+c?(l.attr("transform","translate("+(-c-20)+","+-((o-20)/2-2)+")"),n.attr("x",-(c+10+20)).attr("y",-(o+20)/2)):(l.attr("transform","translate(20,"+-((o-20)/2-2)+")"),n.attr("x",10).attr("y",-(o+20)/2)),t}!function(){if(g){var t,r,e=4,i=d3.scaleTime().nice().domain(d3.extent(g,function(t){return t.date})).range([0,f]),a=d3.scaleLinear().domain([0,d3.max(g,function(t){return t.value})]).range([h,0]),n=d3.select("#"+c),l=d/300;t=n.append("svg").attr("width",d).attr("height",300).attr("perserveAspectRatio","xMidYMid meet").attr("viewBox","0 0 "+d+" 300").append("g").attr("transform","translate("+s+","+u+")"),w(window).resize(function(){var t=n.node().getBoundingClientRect().width;n.selectAll("svg").attr("width",t),n.selectAll("svg").attr("height",t/l)}),t.append("g").call(function(t){t.attr("transform","translate(0,"+h+")").call(d3.axisBottom(i).ticks(d3.timeMonth,1).tickFormat(o?d3.timeFormat("%b"):d3.timeFormat("%B"))).call(function(t){t.select(".domain").remove()})}),t.append("g").call(function(t){t.attr("class","yAxis").call(d3.axisLeft(a).ticks(e).tickFormat(d3.format(".2s")).tickSize(-1*f)).call(function(t){t.select(".domain").remove()})}),t.append("path").datum(g).attr("fill","none").attr("stroke-width",x).attr("stroke","black").attr("class","line "+p).attr("d",d3.line().x(function(t){return i(t.date)}).y(function(t){return a(t.value)})),t.append("g").selectAll("circle").data(g.filter(function(t){return t.event})).enter("circle").append("circle").attr("class","circle "+p).attr("r",y).attr("cx",function(t){return i(t.date)}).attr("cy",function(t){return a(t.value)}),r=t.append("g"),t.append("rect").attr("class","overlay").attr("pointer-events","all").attr("x",0).attr("y",0).attr("width",f).attr("height",h).on("touchmove mousemove",function(){var t=function(t){var e=d3.bisector(function(t){return t.date}).left,r=i.invert(t),a=e(g,r,1),n=g[a-1],l=g[a];return r-n.date>l.date-r?l:n}(d3.mouse(this)[0]),e=t.date.toLocaleString(void 0,m)+"\n"+d3.format(",")(t.value);r.attr("transform","translate("+i(t.date)+","+a(t.value)+")").call(v,e,i(t.date),t.event),t.event?(w("#label-date").text(t.date.toLocaleString(void 0,m)),w("#label-name").text(t.event),w("#linechart-label").css("opacity",1),w("#linechart-label").css("max-height","10rem")):(w("#linechart-label").css("opacity",0),w("#linechart-label").css("max-height","2rem"))}).on("touchend mouseleave",function(){r.call(v,null)})}}()}w(".d3-linechart").each(function(){t(this.id)})});
//# sourceMappingURL=maps/datavis.min.js.map
