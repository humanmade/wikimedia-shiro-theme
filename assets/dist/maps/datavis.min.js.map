{"version":3,"sources":["datavis.min.js"],"names":["jQuery","document","ready","$","each","id","$id","margin","numFormat","d3","format","width","shift","x","y","maxFeature1","data","maxFeature2","profInRow","Math","max","floor","screenWidth","minWidth","masterunit","moreHorUnits","dataStart","dataEnd","labels","legendLabelDistance","icons","except","exceptLang","exceptHeightMulti","height","yPos","d","i","gutter","xPos","fAttr","sel","shape","attr","parseFloat","selectAll","nodes","getAttribute","svg","editors","articles","views","tooltip","container","select","checks","aspect","mappedData","map","p","index","unitSum","remain","specHorUnits","rows","ceil","unitArray","h","push","value","slice","length","Rows","ddata","maxRows","editorScale","scaleLinear","domain","range","articleScale","viewsUnitScale","viewsYScale","viewsXScale","horUnits","minHeight","append","window","resize","targetWidth","node","getBoundingClientRect","call","g","join","e","articleXShift","a","ix","ry","normalPosX","normalPosY","exceptPosX","exceptPosY","transX","transY","offset","labelX","labelY","g1","text","g2","style","borderHeight","endX","v","datalabelText","d0","aObj","vx1","vxCenter","vy1","lastRowOverHalf","customLegend","y2","class","highlight","name","marginBottom","on","_","hover","click","checkBoxStates","transition","editXPos","artXPos","artW","posInRow","min","size","hoverLabels","path","labelPos","is","$elem","fadeIn","fadeOut","addVis","dataProfiles","this","lineChart","isMobile","origWidth","strokeWidth","circleDiameter","accentColorClass","timeFormatPrefs","month","day","year","parseTimeFormat","timeParse","dataRaw","wp","date","callout","evnt","rect","t","split","bbox","getBBox","w","ttipMar","ticks","scaleTime","nice","extent","axisBottom","timeMonth","tickFormat","timeFormat","remove","axisLeft","tickSize","datum","line","filter","event","enter","hoverD","mx","bisect","bisector","left","invert","b","bisectDate","mouse","context","toLocaleString","undefined","css"],"mappings":"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","file":"../datavis.min.js","sourcesContent":["/* global d3 */\n/* eslint-disable no-magic-numbers */\n\njQuery(document).ready(function($) {\n\n\t'use strict';\n\n\tfunction dataProfiles(id) {\n\t\tvar $id = $(\"#\" + id),\n\t\t\tmargin = 10,\n\t\t\tstrokeW = 2,\n\t\t\tnumFormat = d3.format(\",\"),\n\t\t\twidth = $id.width(),\n\t\t\tshift = { x: 190, y: 125 },\n\t\t\tmaxFeature1 = $id.data(\"max-feature-1\") ? $id.data(\"max-feature-1\") : 90,\n\t\t\tmaxFeature2 = $id.data(\"max-feature-2\") ? $id.data(\"max-feature-2\") : 90,\n\t\t\tprofInRow = Math.max(Math.floor(width / shift.x), 2),\n\t\t\tscreenWidth = $(\"body\").width(),\n\t\t\tminWidth = shift.x * profInRow,\n\t\t\tsmallBp = 500, // per _variables.scss\n\t\t\tmasterunit = $id.data(\"chart-masterunit\") ? $id.data(\"chart-masterunit\") : 500000,\n\t\t\thorUnits = 5,\n\t\t\tmoreHorUnits = 30,\n\t\t\tdata = $id.data(\"chart-raw\"),\n\t\t\tdataStart = $id.data(\"slice-start\"),\n\t\t\tdataEnd = $id.data(\"slice-end\"),\n\t\t\t// This is setup so properties/labels don't matter\n\t\t\t// But labels map to this order: circle, rectangle, ellipses\n\t\t\tlabels = $id.data(\"chart-labels\"),\n\t\t\tlegendLabelDistance = 45,\n\t\t\ticons = $id.data(\"chart-icons\"),\n\t\t\texcept = $id.data(\"chart-except\"),\n\t\t\texceptI = 0,\n\t\t\texceptLang = except ? data[labels[exceptI]] : \"\",\n\t\t\texceptHeightMulti = 3.5,\n\t\t\theight = except ? shift.y * exceptHeightMulti : yPos(null, dataEnd - dataStart -1) + shift.y;\n\n\t\tfunction yPos(d, i) {\n\t\t\tvar gutter = margin * 6,\n\t\t\t\ttopmargin = except ? 0 : margin * 5;\n\t\t\treturn topmargin + (shift.y + gutter) * Math.floor(i / profInRow);\n\t\t}\n\n\t\tfunction xPos(d, i) {\n\t\t\treturn i % profInRow * shift.x;\n\t\t}\n\n\t\tfunction fAttr(sel, shape, i, attr) {\n\t\t\treturn parseFloat(sel.selectAll(shape).nodes()[i].getAttribute(attr));\n\t\t}\n\n\t\tfunction addVis() {\n\t\t\tif (!data) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfunction editorsConstruct(g) {\n\t\t\t\treturn g\n\t\t\t\t\t.attr(\"transform\", \"translate(\" + margin + \",\" + margin + \")\")\n\t\t\t\t\t.attr(\"class\", \"profile-feature1\")\n\t\t\t\t\t.selectAll(\"circle\")\n\t\t\t\t\t.data(ddata)\n\t\t\t\t\t.join(\"circle\")\n\t\t\t\t\t.attr(\"cx\", function(d, i) {return except ? xPos(d, i) + Math.max(width/4, editorScale(d[labels[1]]) + margin) : xPos(d, i) + editorScale(d[labels[1]])})\n\t\t\t\t\t.attr(\"cy\", function(d, i) {return yPos(d, i) + editorScale(d[labels[1]])})\n\t\t\t\t\t.attr(\"r\", function(d) {return editorScale(d[labels[1]])})\n\t\t\t}\n\n\t\t\tfunction articlesConstruct(g, e) {\n\t\t\t\tvar articleXShift = width < minWidth ? width*0.5 : width*0.4;\n\t\t\t\treturn g\n\t\t\t\t\t.attr(\"transform\", \"translate(\" + margin + \",\" + margin + \")\")\n\t\t\t\t\t.attr(\"class\", \"profile-feature2\")\n\t\t\t\t\t.selectAll(\"rect\")\n\t\t\t\t\t.data(ddata)\n\t\t\t\t\t.join(\"rect\")\n\t\t\t\t\t.attr(\"x\", function(d, i) {return except ? articleXShift + (width/2-articleScale(d[labels[2]])*0.75)/2 : fAttr(e, \"circle\", i, \"cx\") + fAttr(e, \"circle\", i, \"r\") + margin/2})\n\t\t\t\t\t.attr(\"y\", function(d, i) {return yPos(d, i)})\n\t\t\t\t\t.attr(\"width\", function(d) {return articleScale(d[labels[2]])*0.75})\n\t\t\t\t\t.attr(\"height\", function(d) {return articleScale(d[labels[2]])})\n\t\t\t\t\t.attr(\"rx\", function(d) {return articleScale(d[labels[2]])*0.08})\n\t\t\t\t\t.attr(\"ry\", function(d) {return articleScale(d[labels[2]])*0.08});\n\t\t\t}\n\n\t\t\tfunction viewsConstruct(g, e, a) {\n\t\t\t\tg.attr(\"class\", \"profile-feature3\");\n\t\t\t\t/* eslint-disable no-loop-func, one-var */\n\t\t\t\tfor (var ix = 0; ix < ddata.length; ix++) {\n\t\t\t\t\tvar ry = viewsUnitScale(masterunit) / 3 * 2,\n\t\t\t\t\t\tnormalPosX = fAttr(a, \"rect\", ix, \"x\") + fAttr(a, \"rect\", ix, \"width\") + margin,\n\t\t\t\t\t\tnormalPosY = fAttr(a, \"rect\", ix, \"y\") + ry,\n\t\t\t\t\t\texceptPosX = width < minWidth ? margin * 3 : (width - viewsXScale(moreHorUnits)) / 2, // center\n\t\t\t\t\t\texceptPosY = fAttr(e, \"circle\", ix, \"cx\") + fAttr(e, \"circle\", ix, \"r\") + legendLabelDistance + margin * 2,\n\t\t\t\t\t\ttransX = except ? exceptPosX : normalPosX,\n\t\t\t\t\t\ttransY = except ? exceptPosY : normalPosY;\n\n\t\t\t\t\tg\n\t\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t\t.attr(\"class\", \"viewsContainer\")\n\t\t\t\t\t\t.attr(\"transform\", \"translate(\" + margin + \",\" + margin + \")\")\n\t\t\t\t\t\t.selectAll(\"ellipse\")\n\t\t\t\t\t\t.data(ddata[ix].unitArray)\n\t\t\t\t\t\t.join(\"ellipse\")\n\t\t\t\t\t\t.attr(\"class\", \"views-\" + ix)\n\t\t\t\t\t\t.attr(\"cx\", function(d) {return transX + viewsXScale(d.x)})\n\t\t\t\t\t\t.attr(\"cy\", function(d) {return transY + viewsYScale(d.y)})\n\t\t\t\t\t\t.attr(\"rx\", function(d) {return viewsUnitScale(d.value)})\n\t\t\t\t\t\t.attr(\"ry\", function(d) {return viewsUnitScale(d.value)/3*2});\n\t\t\t\t\t/* eslint-disable no-loop-func, one-var */\n\t\t\t\t}\n\n\t\t\t\treturn g;\n\t\t\t}\n\n\t\t\tfunction labelConstruct(g, e, offset) {\n\t\t\t\tvar labelX = except ? margin*exceptHeightMulti + margin : margin * 2,\n\t\t\t\t\tlabelY = except ? height - margin : shift.y*0.75 + margin;\n\t\t\t\treturn g\n\t\t\t\t\t.call(function(g1) {\n\t\t\t\t\t\treturn g1\n\t\t\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t\t\t.attr(\"class\", \"main-labels\")\n\t\t\t\t\t\t\t.selectAll(\"text\")\n\t\t\t\t\t\t\t.data(ddata)\n\t\t\t\t\t\t\t.join(\"text\")\n\t\t\t\t\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t\t\t\t\t.attr(\"dy\", -5) // create some padding at the bottom\n\t\t\t\t\t\t\t.attr(\"x\", function(d, i) {return screenWidth < smallBp ? xPos(d, i) + margin : xPos(d, i) + labelX})\n\t\t\t\t\t\t\t.attr(\"y\", function(d, i) {return yPos(d, i) + labelY})\n\t\t\t\t\t\t\t.text(function(d) {return labels.length > 4 ? d[labels[4]] : d[labels[0]] })\n\t\t\t\t\t})\n\t\t\t\t\t.call(function(g2) {\n\t\t\t\t\t\treturn g2\n\t\t\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t\t\t.attr(\"class\", \"main-label-ranks\")\n\t\t\t\t\t\t\t.style(\"display\", \"none\")\n\t\t\t\t\t\t\t.selectAll(\"text\")\n\t\t\t\t\t\t\t.data(ddata)\n\t\t\t\t\t\t\t.join(\"text\")\n\t\t\t\t\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t\t\t\t\t.attr(\"dy\", -30) // above mainlabel\n\t\t\t\t\t\t\t.attr(\"x\", function(d, i) {return screenWidth < smallBp ? xPos(d, i) + margin * 2 : xPos(d, i) + labelX})\n\t\t\t\t\t\t\t.attr(\"y\", function(d, i) {return yPos(d, i) + labelY})\n\t\t\t\t\t\t\t.text(function(d, i) {return i + 1 + offset});\n\t\t\t\t\t})\n\t\t\t}\n\n\n\t\t\tfunction borderleft(g) {\n\t\t\t\tvar borderHeight = except ? height : shift.y - margin,\n\t\t\t\t\tendX = except ? margin * exceptHeightMulti : margin;\n\t\t\t\treturn g\n\t\t\t\t\t.attr(\"stroke-width\", strokeW)\n\t\t\t\t\t.attr(\"class\", \"borderleft\")\n\t\t\t\t\t.selectAll(\"line\")\n\t\t\t\t\t.data(ddata)\n\t\t\t\t\t.join(\"line\")\n\t\t\t\t\t.attr(\"x1\", function(d, i) {return xPos(d, i) + strokeW})\n\t\t\t\t\t.attr(\"x2\", function(d, i) {return screenWidth < smallBp ? xPos(d, i) + strokeW : xPos(d, i) + endX})\n\t\t\t\t\t.attr(\"y1\", function(d, i) {return yPos(d, i)})\n\t\t\t\t\t.attr(\"y2\", function(d, i) {return yPos(d, i) + borderHeight});\n\t\t\t}\n\n\t\t\tfunction legendConstruct(g, e, a, v) {\n\t\t\t\tvar datalabelText,\n\t\t\t\t\td0 = ddata[0],\n\t\t\t\t\taObj = {\n\t\t\t\t\t\tx: fAttr(a, \"rect\", 0, \"x\"),\n\t\t\t\t\t\ty: fAttr(a, \"rect\", 0, \"y\"),\n\t\t\t\t\t\tw: fAttr(a, \"rect\", 0, \"width\"),\n\t\t\t\t\t\th: fAttr(a, \"rect\", 0, \"height\"),\n\t\t\t\t\t},\n\t\t\t\t\tvx1 = fAttr(v, \"ellipse\", moreHorUnits-1, \"cx\"),\n\t\t\t\t\tvxCenter = fAttr(v, \"ellipse\", Math.floor(moreHorUnits/2) - 1, \"cx\"),\n\t\t\t\t\tvy1 = fAttr(v, \"ellipse\", moreHorUnits * (d0.Rows - 1), \"cy\"),\n\t\t\t\t\tlastRowOverHalf = moreHorUnits * d0.Rows % d0.unitArray.length > Math.ceil(moreHorUnits/2) + 1,\n\t\t\t\t\tmarginBottom = 60,\n\t\t\t\t\tcustomLegend = [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tx: fAttr(e, \"circle\", 0, \"cx\"),\n\t\t\t\t\t\t\ty: fAttr(e, \"circle\", 0, \"cy\") + fAttr(e, \"circle\", 0, \"r\") - margin,\n\t\t\t\t\t\t\ty2: height - marginBottom,\n\t\t\t\t\t\t\th: legendLabelDistance,\n\t\t\t\t\t\t\tclass: \"profile-feature1\",\n\t\t\t\t\t\t\thighlight: true,\n\t\t\t\t\t\t\tname: [numFormat(d0[labels[1]]) + \" \" + labels[1]]\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tx: aObj.x + aObj.w * 0.5,\n\t\t\t\t\t\t\ty: aObj.y + aObj.h - margin,\n\t\t\t\t\t\t\ty2: height - marginBottom,\n\t\t\t\t\t\t\th: legendLabelDistance,\n\t\t\t\t\t\t\tclass: \"profile-feature2\",\n\t\t\t\t\t\t\thighlight: true,\n\t\t\t\t\t\t\tname: [numFormat(d0[labels[2]]) + \" \" + labels[2]]\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tx: vxCenter,\n\t\t\t\t\t\t\ty: lastRowOverHalf ? vy1 : vy1 + margin,\n\t\t\t\t\t\t\ty2: height - marginBottom * 1.5,\n\t\t\t\t\t\t\th: legendLabelDistance,\n\t\t\t\t\t\t\tclass: \"profile-feature3\",\n\t\t\t\t\t\t\thighlight: true,\n\t\t\t\t\t\t\tname: [numFormat(d0[labels[3]]) + \" \" + labels[3]]\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tx: vx1,\n\t\t\t\t\t\t\ty: vy1 - margin,\n\t\t\t\t\t\t\ty2: height - marginBottom * 2,\n\t\t\t\t\t\t\th: legendLabelDistance/2,\n\t\t\t\t\t\t\tclass: \"profile-feature3\",\n\t\t\t\t\t\t\thighlight: false,\n\t\t\t\t\t\t\tname: [numFormat(masterunit), labels[3]]\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\n\t\t\t\tg\n\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t.attr(\"transform\", \"translate(\" + margin + \",\" + margin + \")\")\n\t\t\t\t\t.attr(\"class\", \"data-label-lines\")\n\t\t\t\t\t.selectAll(\"line\")\n\t\t\t\t\t.data(customLegend)\n\t\t\t\t\t.join(\"line\")\n\t\t\t\t\t.attr(\"class\", function(d) {return d.class})\n\t\t\t\t\t.attr(\"x1\", function(d) {return d.x})\n\t\t\t\t\t.attr(\"x2\", function(d) {return d.x})\n\t\t\t\t\t.attr(\"y1\", function(d) {return d.y})\n\t\t\t\t\t.attr(\"y2\", function(d) {return d.y + d.h})\n\t\t\t\t\t.attr(\"stroke-dasharray\", function(d) {return d.highlight ? \"\" : margin/3 + \",\" + margin/4})\n\n\t\t\t\tdatalabelText = g\n\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t.attr(\"transform\", \"translate(\" + margin + \",\" + margin + \")\")\n\t\t\t\t\t.attr(\"class\", \"data-label-text\")\n\t\t\t\t\t.selectAll(\"text\")\n\t\t\t\t\t.data(customLegend)\n\t\t\t\t\t.join(\"text\")\n\t\t\t\t\t.attr(\"class\", function(d) {return d.class})\n\t\t\t\t\t.attr(\"x\", function(d) {return d.x})\n\t\t\t\t\t.attr(\"y\", function(d) {return d.y + d.h})\n\t\t\t\t\t.attr(\"dy\", margin*1.5)\n\t\t\t\t\t.attr(\"stroke-width\", 0)\n\t\t\t\t\t.attr(\"font-weight\", function(d) {return d.highlight ? \"bold\" : \"normal\"})\n\t\t\t\t\t.attr(\"text-anchor\", function(d) {return width < minWidth && !d.highlight ? \"end\" : \"middle\"})\n\n\t\t\t\tdatalabelText\n\t\t\t\t\t.append(\"tspan\")\n\t\t\t\t\t.attr(\"x\", function(d) {return d.x})\n\t\t\t\t\t.text(function(d) {return d.name[0]});\n\n\t\t\t\tdatalabelText\n\t\t\t\t\t.append(\"tspan\")\n\t\t\t\t\t.attr(\"x\", function(d) {return d.x})\n\t\t\t\t\t.attr(\"dy\", 16)\n\t\t\t\t\t.text(function(d) {return d.name[1]});\n\n\t\t\t\treturn g;\n\t\t\t}\n\n\t\t\tfunction mappedViewsData(_data) {\n\t\t\t\treturn _data.map(function(p, index) {\n\t\t\t\t\tvar unitSum = Math.floor(p[labels[3]]/masterunit),\n\t\t\t\t\t\tremain = p[labels[3]] % masterunit,\n\t\t\t\t\t\tspecHorUnits = index === exceptI ? moreHorUnits : horUnits,\n\t\t\t\t\t\trows = Math.ceil(unitSum/specHorUnits);\n\t\t\t\t\tp.unitArray = [];\n\t\t\t\t\tfor (var i = 0; i < rows; i++) { // eslint-disable-line one-var\n\t\t\t\t\t\tfor (var h = 0; h < specHorUnits; h++) { // eslint-disable-line one-var\n\t\t\t\t\t\t\tp.unitArray.push({ x: h, y: i, value: masterunit })\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tp.unitArray = p.unitArray.slice(0, unitSum); // only take the amount of spaces needed\n\t\t\t\t\tp.unitArray[p.unitArray.length-1].value = remain; // last space is the remainder, not a full masterunit\n\t\t\t\t\tp.Rows = rows;\n\t\t\t\t\treturn p;\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction hover(g, index, e, a, v) { //eslint-disable-line max-params\n\t\t\t\tif (index === null) return g\n\t\t\t\t\t.transition()\n\t\t\t\t\t.attr(\"opacity\", 0)\n\t\t\t\t\t.transition()\n\t\t\t\t\t.style(\"display\", \"none\");\n\n\t\t\t\tvar editXPos = fAttr(e, \"circle\", index, \"cx\"),\n\t\t\t\t\tartXPos = fAttr(a, \"rect\", index, \"x\"),\n\t\t\t\t\tartW = fAttr(a, \"rect\", index, \"width\"),\n\t\t\t\t\tposInRow = fAttr(v, \".views-\" + index, Math.min(Math.floor(horUnits/2), ddata[index].unitArray.length - 1), \"cx\") + margin,\n\t\t\t\t\tsize = margin,\n\t\t\t\t\thoverLabels = [{\n\t\t\t\t\t\tvalue: ddata[index][labels[1]],\n\t\t\t\t\t\tpath: \"M\" + (editXPos + margin) + \" \" + (yPos(null, index) + margin) + \"v -36h\",\n\t\t\t\t\t\tlabelPos: [editXPos, yPos(null, index) - 36]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: ddata[index][labels[2]],\n\t\t\t\t\t\tpath: \"M\" + (artXPos + margin + artW/2) + \" \" + (yPos(null, index) + margin) + \"v -18h\",\n\t\t\t\t\t\tlabelPos: [artXPos + artW / 2, yPos(null, index) - 18]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tvalue: ddata[index][labels[3]],\n\t\t\t\t\t\tpath: \"M\" + posInRow + \" \" + (yPos(null, index) + margin*0.7) + \"v -6h\",\n\t\t\t\t\t\tlabelPos: [posInRow - margin, yPos(null, index) - 6]\n\t\t\t\t\t}\n\t\t\t\t\t];\n\n\t\t\t\tg\n\t\t\t\t\t.transition()\n\t\t\t\t\t.attr(\"opacity\", 1)\n\t\t\t\t\t.style(\"display\", null)\n\t\t\t\t\t.style(\"pointer-events\", \"none\")\n\n\t\t\t\tg.selectAll(\"path\")\n\t\t\t\t\t.data(hoverLabels)\n\t\t\t\t\t.join(\"path\")\n\t\t\t\t\t.attr(\"class\", \"hover-label-lines\")\n\t\t\t\t\t.attr(\"d\", function(d) {return d.path})\n\t\t\t\t\t.style(\"display\", function(d, i) {return checks[i].is(\":checked\") ? \"block\" : \"none\" });\n\n\t\t\t\tg.selectAll(\"text\")\n\t\t\t\t\t.data(hoverLabels)\n\t\t\t\t\t.join(\"text\")\n\t\t\t\t\t.attr(\"x\", function(d) {return d.labelPos[0]})\n\t\t\t\t\t.attr(\"y\", function(d) {return d.labelPos[1]})\n\t\t\t\t\t.attr(\"dy\", margin*0.5)\n\t\t\t\t\t.attr(\"dx\", margin*2)\n\t\t\t\t\t.text(function(d) {return numFormat(d.value)})\n\t\t\t\t\t.style(\"display\", function(d, i) {return checks[i].is(\":checked\") ? \"block\" : \"none\" });\n\n\t\t\t\tif (labels.length > 4) g.append(\"text\")\n\t\t\t\t\t.attr(\"x\", xPos(0, index) + margin)\n\t\t\t\t\t.attr(\"y\", yPos(null, index) + shift.y)\n\t\t\t\t\t.attr(\"dy\", -margin)\n\t\t\t\t\t.attr(\"dx\", margin)\n\t\t\t\t\t.text(ddata[index][labels[0]]);\n\n\t\t\t\tg.selectAll(\"image\")\n\t\t\t\t\t.data(hoverLabels)\n\t\t\t\t\t.join(\"image\")\n\t\t\t\t\t.attr(\"xlink:href\", function(d, i) {return icons[i]})\n\t\t\t\t\t.attr(\"width\", size)\n\t\t\t\t\t.attr(\"height\", size)\n\t\t\t\t\t.attr(\"x\", function(d) {return d.labelPos[0] + margin*0.5})\n\t\t\t\t\t.attr(\"y\", function(d) {return d.labelPos[1] - size*0.5})\n\t\t\t\t\t.style(\"display\", function(d, i) {return checks[i].is(\":checked\") ? \"block\" : \"none\" });\n\t\t\t\treturn g;\n\t\t\t}\n\n\t\t\tfunction checkBoxStates() {\n\t\t\t\tfor (var i = 0; i < checks.length; i++) {\n\t\t\t\t\tvar $elem = $(\".profile-feature\" + (i + 1));\n\t\t\t\t\tif (checks[i].is(\":checked\")) {\n\t\t\t\t\t\t$elem.fadeIn();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$elem.fadeOut();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!checks[0].is(\":checked\") && !checks[1].is(\":checked\") && !checks[2].is(\":checked\")) {$(\".main-label-ranks\").fadeIn()}\n\t\t\t\telse {$(\".main-label-ranks\").fadeOut()}\n\t\t\t}\n\n\t\t\tvar svg,\n\t\t\t\teditors,\n\t\t\t\tarticles,\n\t\t\t\tviews,\n\t\t\t\ttooltip,\n\t\t\t\tcontainer = d3.select(\"#\" + id),\n\t\t\t\tchecks = [$(\"#feature1\"), $(\"#feature2\"), $(\"#feature3\")],\n\t\t\t\taspect = width / height,\n\t\t\t\tmappedData = mappedViewsData(data),\n\t\t\t\tddata = mappedData.slice(dataStart, dataEnd),\n\t\t\t\tmaxRows = d3.max(mappedData, function(d) { return d.Rows }),\n\t\t\t\tunitR = 4,\n\t\t\t\teditorScale = d3.scaleLinear()\n\t\t\t\t\t.domain([0, d3.max(data, function(d) { return d[labels[1]] })])\n\t\t\t\t\t.range([0, maxFeature1]), //min and max radius of circle\n\t\t\t\tarticleScale = d3.scaleLinear()\n\t\t\t\t\t.domain([0, d3.max(data, function(d) { return d[labels[2]] })])\n\t\t\t\t\t.range([0, maxFeature2]), //min and max height of rect\n\t\t\t\tviewsUnitScale = d3.scaleLinear()\n\t\t\t\t\t.domain([0, masterunit])\n\t\t\t\t\t.range([0, unitR]), // min and max size of of 1 unit\n\t\t\t\tviewsYScale = d3.scaleLinear()\n\t\t\t\t\t.domain([0, maxRows])\n\t\t\t\t\t.range([0, maxRows * unitR * 2]), // min and max space for rows\n\t\t\t\tviewsXScale = d3.scaleLinear()\n\t\t\t\t\t.domain([0, horUnits])\n\t\t\t\t\t.range([0, horUnits * unitR * 2.5]), // min and max space for columns\n\t\t\t\tminHeight = editorScale.range()[1] * 2 + viewsYScale.range()[1] + (legendLabelDistance + margin) * 4;\n\n\t\t\theight = except && height < minHeight ? minHeight : height; // update\n\t\t\texceptHeightMulti = height/shift.y; // update\n\n\t\t\tsvg = container.append(\"svg\")\n\t\t\t\t.attr(\"width\", width)\n\t\t\t\t.attr(\"height\", height)\n\t\t\t\t.attr(\"perserveAspectRatio\", \"xMidYMid meet\")\n\t\t\t\t.attr(\"viewBox\", screenWidth < minWidth ? \"0 0 \" + minWidth + \" \" + minWidth / aspect : \"0 0 \" + width + \" \" + height);\n\n\n\t\t\t// lazy resize, keeps proportions\n\t\t\t$( window ).resize(function(){\n\t\t\t\tvar targetWidth = container.node().getBoundingClientRect().width;\n\t\t\t\tcontainer.selectAll(\"svg\").attr(\"width\", targetWidth);\n\t\t\t\tcontainer.selectAll(\"svg\").attr(\"height\", targetWidth / aspect);\n\t\t\t});\n\n\t\t\teditors = svg.append(\"g\").call(editorsConstruct);\n\t\t\tarticles = svg.append(\"g\").call(articlesConstruct, editors);\n\t\t\tviews = svg.append(\"g\").call(viewsConstruct, editors, articles);\n\n\t\t\tsvg.append(\"g\").call(labelConstruct, editors, dataStart);\n\t\t\tsvg.append(\"g\").call(borderleft);\n\n\t\t\tif (except) {\n\t\t\t\tsvg.append(\"g\").call(legendConstruct, editors, articles, views);\n\t\t\t} else {\n\t\t\t\ttooltip = svg\n\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t.attr(\"class\", \"tooltip\");\n\n\t\t\t\tsvg\n\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t.attr(\"opacity\", 0)\n\t\t\t\t\t.attr(\"class\", \"tooltipgrid\")\n\t\t\t\t\t.selectAll(\"rect\")\n\t\t\t\t\t.data(ddata)\n\t\t\t\t\t.join(\"rect\")\n\t\t\t\t\t.attr(\"class\", \"hover\")\n\t\t\t\t\t.attr(\"x\", function(d, i) {return xPos(d, i)})\n\t\t\t\t\t.attr(\"y\", function(d, i) {return yPos(d, i)})\n\t\t\t\t\t.attr(\"width\", shift.x)\n\t\t\t\t\t.attr(\"height\", shift.y)\n\t\t\t\t\t.on(\"touchstart mouseover\", function(_, i) {\n\t\t\t\t\t\tif (ddata[i][labels[0]] === exceptLang) return;\n\t\t\t\t\t\ttooltip\n\t\t\t\t\t\t\t.call(hover, i, editors, articles, views);\n\t\t\t\t\t})\n\t\t\t\t\t.on(\"touchend mouseout\", function() {tooltip.call(hover, null)});\n\n\t\t\t\t// applies to all, but only runs once\n\t\t\t\t$(\".chart-options input[type='checkbox']\").click(checkBoxStates);\n\t\t\t\tcheckBoxStates();\n\t\t\t}\n\t\t}\n\n\t\taddVis();\n\t}\n\n\t$(\".d3-dataprofiles\").each(function() {\n\t\tdataProfiles(this.id);\n\t});\n\n\n});\n/* global d3 */\n/* eslint-disable no-magic-numbers */\n\njQuery(document).ready(function($) {\n\n\t'use strict';\n\n\tfunction lineChart(id) {\n\t\tvar $id = $(\"#\" + id),\n\t\t\tmobileThresh = 762,\n\t\t\tisMobile = $(window).width() < mobileThresh,\n\t\t\tmargin = { top: 30, right: isMobile ? 20 : 60, bottom: 60, left: 40 },\n\t\t\torigWidth = $id.width(),\n\t\t\twidth = origWidth - margin.left - margin.right,\n\t\t\torigHeight = 300,\n\t\t\theight = origHeight - margin.top - margin.bottom,\n\t\t\tstrokeWidth = 1.5,\n\t\t\tcircleDiameter = 4,\n\t\t\taccentColorClass = $id.data(\"stroke-color\"),\n\t\t\ttimeFormatPrefs = $id.data(\"time-format\") === \"month\" ? { month: \"long\" } : { month: \"short\", day: \"numeric\", year: \"numeric\" },\n\t\t\tparseTimeFormat = d3.timeParse(\"%Y-%m-%d\"),\n\t\t\tdataRaw = $id.data(\"chart-raw\"),\n\t\t\tdata = dataRaw ? dataRaw.map(parseDates) : null;\n\n\t\tfunction parseDates(wp) {\n\t\t\twp.date = parseTimeFormat(wp.date);\n\t\t\treturn wp;\n\t\t}\n\n\t\tfunction callout(g, value, xPos, evnt) {\n\t\t\tif (!value) return g.style(\"display\", \"none\");\n\t\t\tg\n\t\t\t\t.attr(\"class\", \"tooltip\")\n\t\t\t\t.style(\"display\", null)\n\t\t\t\t.style(\"pointer-events\", \"none\");\n\n\t\t\tvar borderRadius = 2,\n\t\t\t\tlineHeight = 1.2,\n\t\t\t\trect = g.selectAll(\"rect\")\n\t\t\t\t\t.data([null])\n\t\t\t\t\t.join(\"rect\")\n\t\t\t\t\t.attr(\"rx\", borderRadius)\n\t\t\t\t\t.attr(\"ry\", borderRadius),\n\t\t\t\ttext = g.selectAll(\"text\")\n\t\t\t\t\t.data([null])\n\t\t\t\t\t.join(\"text\")\n\t\t\t\t\t.call(function(t) {\n\t\t\t\t\t\treturn t\n\t\t\t\t\t\t\t.selectAll(\"tspan\")\n\t\t\t\t\t\t\t.data(value.split(/\\n/))\n\t\t\t\t\t\t\t.join(\"tspan\")\n\t\t\t\t\t\t\t.attr(\"x\", 0)\n\t\t\t\t\t\t\t.attr(\"y\", function(d, i) { return i * lineHeight + \"em\" })\n\t\t\t\t\t\t\t.style(\"font-weight\", function(_, i) { return i ? null : \"bold\" })\n\t\t\t\t\t\t\t.text(function(d) { return d; })\n\t\t\t\t\t}),\n\t\t\t\tbbox = text.node().getBBox(),\n\t\t\t\tw = bbox.width,\n\t\t\t\th = bbox.height,\n\t\t\t\tttipMar = 10,\n\t\t\t\ttotalMar = ttipMar * 2,\n\t\t\t\tshift = 2;\n\n\t\t\tg.selectAll(\"circle\")\n\t\t\t\t.data([null])\n\t\t\t\t.join(\"circle\")\n\t\t\t\t.attr(\"r\", circleDiameter)\n\t\t\t\t.attr(\"stroke-width\", strokeWidth)\n\t\t\t\t.attr(\"fill\", evnt ? \"none\" : \"white\")\n\n\t\t\trect.attr(\"width\", w + totalMar).attr(\"height\", h + totalMar)\n\n\t\t\tif (xPos + w > width) {\n\t\t\t\ttext.attr(\"transform\", \"translate(\" + (-w - totalMar) + \",\" + -((h - totalMar) / 2 - shift) + \")\");\n\t\t\t\trect.attr(\"x\", -(w + ttipMar + totalMar)).attr(\"y\", -(h + totalMar) / 2);\n\t\t\t} else {\n\t\t\t\ttext.attr(\"transform\", \"translate(\" + totalMar + \",\" + -((h - totalMar) / 2 - shift) + \")\");\n\t\t\t\trect.attr(\"x\", ttipMar).attr(\"y\", -(h + totalMar) / 2);\n\t\t\t}\n\n\t\t\treturn g;\n\t\t}\n\n\t\tfunction addVis() {\n\t\t\tif (!data) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar svg,\n\t\t\t\tticks = { x: 0, y: 4 },\n\t\t\t\tx = d3.scaleTime()\n\t\t\t\t\t.nice()\n\t\t\t\t\t.domain(d3.extent(data, function(d) { return d.date; }))\n\t\t\t\t\t.range([0, width]),\n\t\t\t\txAxis = function(g) {\n\t\t\t\t\tg\n\t\t\t\t\t\t.attr(\"transform\", \"translate(0,\" + height + \")\")\n\t\t\t\t\t\t.call(d3.axisBottom(x)\n\t\t\t\t\t\t\t.ticks(d3.timeMonth, 1)\n\t\t\t\t\t\t\t.tickFormat(isMobile ? d3.timeFormat(\"%b\") : d3.timeFormat(\"%B\")))\n\t\t\t\t\t\t.call(function(h) { h.select(\".domain\").remove(); })\n\t\t\t\t},\n\t\t\t\ty = d3.scaleLinear()\n\t\t\t\t\t.domain([0, d3.max(data, function(d) { return d.value; })])\n\t\t\t\t\t.range([height, 0]),\n\t\t\t\tyAxis = function(g) {\n\t\t\t\t\tg\n\t\t\t\t\t\t.attr(\"class\", \"yAxis\")\n\t\t\t\t\t\t.call(d3.axisLeft(y)\n\t\t\t\t\t\t\t.ticks(ticks.y)\n\t\t\t\t\t\t\t.tickFormat(d3.format(\".2s\"))\n\t\t\t\t\t\t\t.tickSize(-1 * width))\n\t\t\t\t\t\t.call(function(h) { h.select(\".domain\").remove(); })\n\t\t\t\t},\n\t\t\t\tbisectDate = function(mx) {\n\t\t\t\t\tvar bisect = d3.bisector(function(d) { return d.date }).left,\n\t\t\t\t\t\tdate = x.invert(mx),\n\t\t\t\t\t\tindex = bisect(data, date, 1),\n\t\t\t\t\t\ta = data[index - 1],\n\t\t\t\t\t\tb = data[index];\n\t\t\t\t\treturn date - a.date > b.date - date ? b : a;\n\t\t\t\t},\n\t\t\t\ttooltip,\n\t\t\t\tcontainer = d3.select(\"#\" + id),\n\t\t\t\taspect = origWidth / origHeight;\n\n\t\t\tsvg = container.append(\"svg\")\n\t\t\t\t.attr(\"width\", origWidth)\n\t\t\t\t.attr(\"height\", origHeight)\n\t\t\t\t.attr(\"perserveAspectRatio\", \"xMidYMid meet\")\n\t\t\t\t.attr(\"viewBox\", \"0 0 \" + origWidth + \" \" + origHeight)\n\t\t\t\t.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n\t\t\t// lazy resize, keeps proportions\n\t\t\t$( window ).resize(function() {\n\t\t\t\tvar targetWidth = container.node().getBoundingClientRect().width;\n\t\t\t\tcontainer.selectAll(\"svg\").attr(\"width\", targetWidth);\n\t\t\t\tcontainer.selectAll(\"svg\").attr(\"height\", targetWidth / aspect);\n\t\t\t});\n\n\t\t\tsvg.append(\"g\").call(xAxis);\n\t\t\tsvg.append(\"g\").call(yAxis);\n\n\t\t\tsvg.append(\"path\")\n\t\t\t\t.datum(data)\n\t\t\t\t.attr(\"fill\", \"none\")\n\t\t\t\t.attr(\"stroke-width\", strokeWidth)\n\t\t\t\t.attr(\"stroke\", \"black\")\n\t\t\t\t.attr(\"class\", \"line \" + accentColorClass)\n\t\t\t\t.attr(\"d\", d3.line()\n\t\t\t\t\t.x(function(d) { return x(d.date) })\n\t\t\t\t\t.y(function(d) { return y(d.value) })\n\t\t\t\t);\n\n\t\t\tsvg.append(\"g\")\n\t\t\t\t.selectAll(\"circle\")\n\t\t\t\t.data(data.filter(function(d) { return d.event; }))\n\t\t\t\t.enter(\"circle\")\n\t\t\t\t.append(\"circle\")\n\t\t\t\t.attr(\"class\", \"circle \" + accentColorClass)\n\t\t\t\t.attr(\"r\", circleDiameter)\n\t\t\t\t.attr(\"cx\", function(d) { return x(d.date); })\n\t\t\t\t.attr(\"cy\", function(d) { return y(d.value); });\n\n\t\t\ttooltip = svg.append(\"g\");\n\n\t\t\tsvg.append('rect')\n\t\t\t\t.attr(\"class\", \"overlay\")\n\t\t\t\t.attr(\"pointer-events\", \"all\")\n\t\t\t\t.attr('x', 0)\n\t\t\t\t.attr('y', 0)\n\t\t\t\t.attr('width', width)\n\t\t\t\t.attr('height', height)\n\t\t\t\t.on(\"touchmove mousemove\", function() {\n\t\t\t\t\tvar hoverD = bisectDate(d3.mouse(this)[0]),\n\t\t\t\t\t\tcontext = hoverD.date.toLocaleString(undefined, timeFormatPrefs) + \"\\n\" + d3.format(\",\")(hoverD.value);\n\t\t\t\t\ttooltip\n\t\t\t\t\t\t.attr(\"transform\", \"translate(\" + x(hoverD.date) + \",\" + y(hoverD.value) + \")\")\n\t\t\t\t\t\t.call(callout, context, x(hoverD.date), hoverD.event);\n\t\t\t\t\tif (hoverD.event) {\n\t\t\t\t\t\t$(\"#label-date\").text(hoverD.date.toLocaleString(undefined, timeFormatPrefs));\n\t\t\t\t\t\t$(\"#label-name\").text(hoverD.event);\n\t\t\t\t\t\t$(\"#linechart-label\").css(\"opacity\", 1);\n\t\t\t\t\t\t$(\"#linechart-label\").css(\"max-height\", 10 + \"rem\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\"#linechart-label\").css(\"opacity\", 0);\n\t\t\t\t\t\t$(\"#linechart-label\").css(\"max-height\", 2 + \"rem\");\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.on(\"touchend mouseleave\", function() {\n\t\t\t\t\ttooltip.call(callout, null);\n\t\t\t\t});\n\t\t}\n\n\t\taddVis();\n\n\t}\n\n\t$(\".d3-linechart\").each(function() {\n\t\tlineChart(this.id);\n\t});\n\n\n});"]}