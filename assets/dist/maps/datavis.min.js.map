{"version":3,"sources":["datavis.min.js"],"names":["jQuery","document","ready","$","each","id","$id","margin","width","height","accentColorClass","data","bisectDate","d3","bisector","d","date","left","tickTimeFormat","timeFormat","parseTimeFormat","timeParse","i","length","svg","select","append","attr","x","scaleTime","domain","extent","range","xAxis","axisBottom","ticks","timeMonth","tickFormat","y","scaleLinear","max","value","yAxis","axisLeft","format","tickSize","call","g","remove","datum","line","selectAll","enter","focuscircle","style","focus","on","x0","invert","mouse","this","d0","d1","lastValue","undefined","tooltipWidth","text","addVisual","lineChart"],"mappings":"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","file":"../datavis.min.js","sourcesContent":["/* global d3 */\n/*eslint no-magic-numbers: [\"error\", { \"ignore\": [0, 1, -1] }]*/\n\njQuery(document).ready(function($) {\n\n\t'use strict';\n\n\tfunction lineChart(id) {\n\t\tvar $id = $(\"#\" + id),\n\t\t\tmargin = { top: 30, right: 60, bottom: 60, left: 60 },\n\t\t\twidth = $id.width() - margin.left - margin.right,\n\t\t\torgiHeight = 300,\n\t\t\theight = orgiHeight - margin.top - margin.bottom,\n\t\t\taccentColorClass = $id.data(\"stroke-color\"),\n\t\t\tbisectDate = d3.bisector(function(d) { return d.date; }).left,\n\t\t\ttickTimeFormat = $id.data(\"time-format\") === \"month\" ? d3.timeFormat(\"%B\") : d3.timeFormat(\"%b %d, %Y\"),\n\t\t\tparseTimeFormat = d3.timeParse(\"%Y-%m-%d\");\n\n\t\tfunction addVisual(data) {\n\n\t\t\tif (!data) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar svg = d3.select(\"#\" + id)\n\t\t\t\t\t.append(\"svg\")\n\t\t\t\t\t.attr(\"width\", width + margin.left + margin.right)\n\t\t\t\t\t.attr(\"height\", height + margin.top + margin.bottom)\n\t\t\t\t\t.append(\"g\")\n\t\t\t\t\t.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\"),\n\t\t\t\tx = d3.scaleTime()\n\t\t\t\t\t.domain(d3.extent(data, function(d) { return d.date; }))\n\t\t\t\t\t.range([0, width]),\n\t\t\t\txAxis = d3.axisBottom(x)\n\t\t\t\t\t.ticks(d3.timeMonth, 1)\n\t\t\t\t\t.tickFormat(d3.timeFormat(\"%B\")),\n\t\t\t\ty = d3.scaleLinear()\n\t\t\t\t\t.domain([0, d3.max(data, function(d) { return d.value; })])\n\t\t\t\t\t.range([height, 0]),\n\t\t\t\tyAxis = d3.axisLeft(y)\n\t\t\t\t\t.ticks(4) // eslint-disable-line no-magic-numbers\n\t\t\t\t\t.tickFormat(d3.format(\".2s\"))\n\t\t\t\t\t.tickSize(-1 * width);\n\n\t\t\tsvg.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(0,\" + height + \")\")\n\t\t\t\t.call(xAxis);\n\n\t\t\tsvg.append(\"g\")\n\t\t\t\t.attr(\"class\", \"yAxis\")\n\t\t\t\t.call(yAxis)\n\t\t\t\t.call(function(g) { g.select(\".domain\").remove(); });\n\n\t\t\tsvg.append(\"path\")\n\t\t\t\t.datum(data)\n\t\t\t\t.attr(\"fill\", \"none\")\n\t\t\t\t.attr(\"stroke-width\", 1.5) // eslint-disable-line no-magic-numbers\n\t\t\t\t.attr(\"stroke\", \"black\")\n\t\t\t\t.attr(\"class\", \"line \" + accentColorClass)\n\t\t\t\t.attr(\"d\", d3.line()\n\t\t\t\t\t.x(function(d) { return x(d.date) })\n\t\t\t\t\t.y(function(d) { return y(d.value) })\n\t\t\t\t)\n\n\t\t\tsvg.selectAll(\"dot\")\n\t\t\t\t.data(data)\n\t\t\t\t.enter().append(\"circle\")\n\t\t\t\t.attr(\"r\", 1) // eslint-disable-line no-magic-numbers\n\t\t\t\t.attr(\"cx\", function(d) { return x(d.date); })\n\t\t\t\t.attr(\"cy\", function(d) { return y(d.value); })\n\t\t\t\t.attr(\"class\", \"circle \" + accentColorClass);\n\n\t\t\tvar focuscircle = svg.append(\"g\") // eslint-disable-line one-var\n\t\t\t\t\t.append(\"circle\")\n\t\t\t\t\t.attr(\"r\", 4) // eslint-disable-line no-magic-numbers\n\t\t\t\t\t.attr(\"class\", \"circle \" + accentColorClass)\n\t\t\t\t\t.style(\"display\", \"none\"),\n\t\t\t\tfocus = svg.append(\"g\")\n\t\t\t\t\t.attr(\"class\", \"focus\")\n\t\t\t\t\t.style(\"display\", \"none\"),\n\t\t\t\ttooltipWidth = 100;\n\n\t\t\tfocus.append(\"rect\")\n\t\t\t\t.attr(\"class\", \"tooltip\")\n\t\t\t\t.attr(\"width\", tooltipWidth)\n\t\t\t\t.attr(\"height\", 50) // eslint-disable-line no-magic-numbers\n\t\t\t\t.attr(\"x\", 10) // eslint-disable-line no-magic-numbers\n\t\t\t\t.attr(\"y\", -22) // eslint-disable-line no-magic-numbers\n\t\t\t\t.attr(\"rx\", 4) // eslint-disable-line no-magic-numbers\n\t\t\t\t.attr(\"ry\", 4); // eslint-disable-line no-magic-numbers\n\n\t\t\tfocus.append(\"text\")\n\t\t\t\t.attr(\"class\", \"tooltip-date\")\n\t\t\t\t.attr(\"x\", 18) // eslint-disable-line no-magic-numbers\n\t\t\t\t.attr(\"y\", -2); // eslint-disable-line no-magic-numbers\n\n\t\t\tfocus.append(\"text\")\n\t\t\t\t.attr(\"class\", \"tooltip-value\")\n\t\t\t\t.attr(\"x\", 18) // eslint-disable-line no-magic-numbers\n\t\t\t\t.attr(\"y\", 18); // eslint-disable-line no-magic-numbers\n\n\t\t\tsvg.append(\"rect\")\n\t\t\t\t.attr(\"class\", \"overlay\")\n\t\t\t\t.attr(\"width\", width)\n\t\t\t\t.attr(\"height\", height)\n\t\t\t\t.on(\"mouseover\", function() {\n\t\t\t\t\tfocus.style(\"display\", null);\n\t\t\t\t\tfocuscircle.style(\"display\", null);\n\t\t\t\t})\n\t\t\t\t.on(\"mouseout\", function() {\n\t\t\t\t\tfocus.style(\"display\", \"none\");\n\t\t\t\t\tfocuscircle.style(\"display\", \"none\");\n\t\t\t\t})\n\t\t\t\t.on(\"mousemove\", mousemove);\n\n\t\t\tfunction mousemove() {\n\t\t\t\tvar x0 = x.invert(d3.mouse(this)[0]),\n\t\t\t\t\ti = bisectDate(data, x0, 1),\n\t\t\t\t\td0 = data[i - 1],\n\t\t\t\t\td1 = data[i],\n\t\t\t\t\td = x0 - d0.date > d1.date - x0 ? d1 : d0,\n\t\t\t\t\tlastValue = data[data.length - 1].value,\n\t\t\t\t\tshift = tooltipWidth + 20; // eslint-disable-line no-magic-numbers\n\t\t\t\tif (data[i + 1] === undefined && d.value === lastValue) {\n\t\t\t\t\tfocus.attr(\"transform\", \"translate(\" + (x(d.date) - shift) + \",\" + y(d.value) + \")\");\n\t\t\t\t} else {\n\t\t\t\t\tfocus.attr(\"transform\", \"translate(\" + x(d.date) + \",\" + y(d.value) + \")\");\n\t\t\t\t}\n\t\t\t\tfocuscircle.attr(\"transform\", \"translate(\" + x(d.date) + \",\" + y(d.value) + \")\");\n\t\t\t\tfocus.select(\".tooltip-date\").text(tickTimeFormat(d.date));\n\t\t\t\tfocus.select(\".tooltip-value\").text(d3.format(\",\")(d.value));\n\t\t\t}\n\n\t\t}\n\n\t\tvar data = $id.data(\"chart-raw\"); // eslint-disable-line one-var\n\n\t\tfor (var i = data.length - 1; i >= 0; i--) { // eslint-disable-line one-var\n\t\t\tdata[i].date = parseTimeFormat(data[i].date);\n\t\t}\n\n\t\taddVisual(data);\n\n\t}\n\n\t$(\".d3-chart\").each(function() {\n\t\tlineChart(this.id);\n\t});\n\n\n});"]}